#!/bin/bash
if [ -z "$1" ]; then
	bc -l
else
	#-# most of this is for storing and getting previous answer.  `bc` line is the only one actually needed otherwise
	#-# uses `ans` varible for answer
	#-# negatives of file storage:
	# - answer is shared between shells
	# - answer never deleted
	# - performance penalty for writing, accessing file
	f="$TJM_DOTFILES_PATH/.c"
	calc="$*"
	match='^[\+-/\*%\^]+ '
	if [[ "$calc" =~ $match ]]; then
		calc="ans $calc"
	fi
	if [[ "$calc" == *"ans"* ]]; then
		ans=$(cat $f)
		if [ -z $ans ]; then
			ans=0
		fi
		calc="ans = ${ans}; ${calc}"
	fi

	#--run calc
	v=$(echo "$calc" | bc -l)

	#--trim trailing 0
	match='0+$'
	if [[ "$v" == *"."* && "$v" =~ $match ]]; then
		v=$(echo $v | sed -r 's/\.?[0]+$//')
	fi

	#--save answer to file and echo
	echo "$v" > $f
	echo "$v"
fi
